<p id="notice"><%= notice %></p>


<div class="container text-white">
    <div class="album text-white">

        
        <h1>Manage Invoices </h1>


        <%= link_to 'New Invoice', new_invoice_path, class: 'btn btn-outline-secondary text-white' %>

        <br>
        <hr class="new1">

        <table id="example" class="table table-dark table-hover table-sm text-nowrap" data-turbolinks="false">

            <thead>
                <tr class="table-dark text-center">
                    <th>Invoice #</th>
                    <th>Invoice Desc.</th>
                    <th>Invoice Date</th>
                    <th>Customer Name</th>
                    <th>Invoice Type</th>
                    <th>Invoice Status</th>
                    <th>View Invoice</th>
                    <th>Edit Invoice</th>
                </tr>
            </thead>

            <tbody>
                <% @invoices.each do |invoice| %>
                <tr>
                    <td><%= invoice.invoice_number %></td>
                    <td class="text-left"><%= invoice.invoice_desc %></td>
                    <td><%= invoice.invoice_date_time.to_formatted_s(:long_ordinal) %></td>
                    <td class="text-center"><%= invoice.customer.first_and_last_no_id %></td>
                    <td class="text-center"><%= invoice.invoice_type.invoice_type %></td>
                    <td class="text-center"><%= invoice.invoice_status.invoice_status %></td>
                    <td><%= link_to 'Show', invoice, class: 'btn btn-info btn-sm text-white' %></td>
                    <td><%= link_to 'Edit', edit_invoice_path(invoice), class: 'btn btn-warning btn-sm' %></td>
                </tr>
                <% end %>
            </tbody>
        </table>
    </div>
</div>

<script type="text/javascript">
    var dataTable = $('#example').DataTable({
        "language": {
            "sLengthMenu": "Num. of Entries Per Page _MENU_",
            "sSearch": "Search:"
        }
    });

    $(document).ready(function() {
        dataTable;
    });

    document.addEventListener("turbolinks:before-cache", function() {
        if (dataTable !== null) {
            dataTable.destroy();
            dataTable = null;
        }
    });
</script>


        Customer.find_by_sql(" select * from invoices inner join customers on invoices.customer_id = customers.id ")
        Customer.joins(:invoices).group(:id).having("count(invoices.id) > 0").limit(10)
        Customer.where(created_at: Date.today.beginning_of_year..Date.today).count
        